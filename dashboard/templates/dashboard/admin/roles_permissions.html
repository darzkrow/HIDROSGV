{% extends 'dashboard/base.html' %}
{% block title %}Gestión de Roles y Permisos{% endblock %}
{% block content %}
<h2>Gestión de Roles y Permisos</h2>
<p>Solo visible para administradores.</p>
{% if message %}
	<div class="alert alert-success">{{ message }}</div>
{% endif %}
<div class="row">
	<div class="col-md-6">
		<h4>Asignar rol a usuario</h4>
		<form method="post">
			{% csrf_token %}
			<div class="mb-2">
				<label>Usuario:</label>
				<select name="user_id" class="form-select">
					{% for user in users %}
						<option value="{{ user.id }}">{{ user.username }} ({{ user.get_full_name }})</option>
					{% endfor %}
				</select>
			</div>
			<div class="mb-2">
				<label>Rol (Grupo):</label>
				<select name="group_id" class="form-select">
					{% for group in groups %}
						<option value="{{ group.id }}">{{ group.name }}</option>
					{% endfor %}
				</select>
			</div>
			<button type="submit" class="btn btn-primary">Asignar rol</button>
		</form>
		<hr>
		<h4>Usuarios</h4>
		<ul>
			{% for user in users %}
				<li>{{ user.username }} ({{ user.get_full_name }}) - Roles: {% for g in user.groups.all %}{{ g.name }} {% empty %}Sin rol{% endfor %}</li>
			{% endfor %}
		</ul>
	</div>
	<div class="col-md-3">
		<h4>Grupos</h4>
		<ul>
			{% for group in groups %}
				<li>{{ group.name }}</li>
			{% endfor %}
		</ul>
	</div>
	<div class="col-md-3">
		<h4>Permisos</h4>
		<ul>
			{% for perm in permissions %}
				<li>{{ perm.name }}</li>
			{% endfor %}
		</ul>
	</div>
</div>
{% endblock %}
